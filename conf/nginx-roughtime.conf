# /etc/nginx/conf.d/roughtime.conf

# UDP RoughTime on 2002 → 127.0.0.1:2002
upstream roughtime_udp_backend {
    server 127.0.0.1:2002;
}

# # TCP RoughTime on 2002 → 127.0.0.1:2002
# upstream roughtime_tcp_backend {
#     server 127.0.0.1:2002;
# }

# ----- UDP server -----
server {
    listen 2002 udp reuseport;
    proxy_pass roughtime_udp_backend;

    # UDP is request/response; RoughTime replies once per request.
    proxy_responses 1;

    proxy_timeout 2s;
    proxy_connect_timeout 2s;

    access_log /var/log/nginx/roughtime-udp.access.log json_stream buffer=32k flush=5s;
    error_log  /var/log/nginx/roughtime-udp.error.log info;
}

# # ----- TCP server -----
# server {
#     listen 2002;               # defaults to TCP
#     proxy_pass roughtime_tcp_backend;

#     proxy_timeout 5s;
#     proxy_connect_timeout 2s;

#     access_log /var/log/nginx/roughtime-tcp.access.log json_stream buffer=32k flush=5s;
#     error_log  /var/log/nginx/roughtime-tcp.error.log info;
# }

# Local Variables:
# mode: conf-space
# End:
